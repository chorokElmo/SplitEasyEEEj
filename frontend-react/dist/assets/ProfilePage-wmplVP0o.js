import{u as E,r as x,w as P,j as e,aZ as D,d as I,a0 as k,a2 as A,Y as F}from"./react-vendor--vquuSlV.js";import{u as L,h as M,g as C,C as p,b as f,c as j,d as U,B as o,a as N,i as T,j as B,I as n}from"./index-CWe1EfRc.js";const V=()=>{const{t:s}=E(),{user:r,updateUser:y}=L(),{toast:c}=M(),[d,h]=x.useState(!1),[t,g]=x.useState({username:r?.username||"",email:r?.email||"",firstName:r?.firstName||"",lastName:r?.lastName||"",phone:r?.phone||""}),[i,m]=x.useState({currentPassword:"",newPassword:"",confirmPassword:""}),w=P({mutationFn:async()=>(await C.put("/auth/me",{firstName:t.firstName,lastName:t.lastName,phone:t.phone})).data,onSuccess:a=>{y(a.data.user),h(!1),c({title:s("notifications.success"),description:s("profile.changesSaved")})},onError:a=>{c({variant:"destructive",title:s("errors.serverError"),description:a.response?.data?.message||s("profile.errorSaving")})}}),v=P({mutationFn:async()=>{const{currentPassword:a,newPassword:u,confirmPassword:S}=i;if(u!==S)throw new Error("Passwords do not match");return(await C.post("/auth/change-password",{currentPassword:a,newPassword:u})).data},onSuccess:()=>{c({title:s("notifications.success")}),m({currentPassword:"",newPassword:"",confirmPassword:""})},onError:a=>{c({variant:"destructive",title:s("profile.passwordChangeFailed"),description:a.response?.data?.message||a.message})}}),l=a=>{g(u=>({...u,[a.target.name]:a.target.value}))},b=()=>{g({username:r?.username||"",email:r?.email||"",firstName:r?.firstName||"",lastName:r?.lastName||"",phone:r?.phone||""}),h(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("profile.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("profile.subtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(p,{className:"lg:col-span-2",children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:s("profile.personalInfo")}),e.jsx(U,{children:s("profile.personalInfo")})]}),d?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>w.mutate(),disabled:w.isLoading,children:s("common.save")}),e.jsx(o,{variant:"outline",onClick:b,children:s("common.cancel")})]}):e.jsxs(o,{onClick:()=>h(!0),children:[e.jsx(D,{className:"me-2 h-4 w-4"}),s("common.edit")]})]})}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center text-white text-xl font-medium ${B(r?.username||"User")}`,children:T(r?.username||"User")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("profile.profilePicture")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("profile.uploadPhoto")}),e.jsx(o,{variant:"outline",size:"sm",className:"mt-2",children:s("profile.uploadPhoto")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s("common.username")}),e.jsx(n,{name:"username",value:t.username,onChange:l,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s("common.email")}),e.jsx(n,{name:"email",type:"email",value:t.email,onChange:l,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s("common.firstName")}),e.jsx(n,{name:"firstName",value:t.firstName,onChange:l,disabled:!d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s("common.lastName")}),e.jsx(n,{name:"lastName",value:t.lastName,onChange:l,disabled:!d})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s("common.phone")}),e.jsx(n,{name:"phone",value:t.phone,onChange:l,disabled:!d})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(f,{children:e.jsx(j,{children:s("profile.accountSettings")})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("profile.memberSince")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?.createdAt?new Date(r.createdAt).toLocaleDateString():s("common.error")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("profile.emailVerified")}),e.jsx("p",{className:"text-sm text-green-600",children:s("profile.verified")})]})]})]})]}),e.jsxs(p,{children:[e.jsx(f,{children:e.jsx(j,{children:s("profile.accountSettings")})}),e.jsx(N,{className:"space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),s("profile.changePassword")]}),e.jsx(n,{type:"password",placeholder:s("profile.currentPassword"),value:i.currentPassword,onChange:a=>m({...i,currentPassword:a.target.value})}),e.jsx(n,{type:"password",placeholder:s("profile.newPassword"),value:i.newPassword,onChange:a=>m({...i,newPassword:a.target.value})}),e.jsx(n,{type:"password",placeholder:s("profile.confirmNewPassword"),value:i.confirmPassword,onChange:a=>m({...i,confirmPassword:a.target.value})}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>v.mutate(),disabled:v.isLoading,children:[e.jsx(F,{className:"h-4 w-4 me-2"}),s("profile.updatePassword")]})]})})]})]})]})]})};export{V as default};
